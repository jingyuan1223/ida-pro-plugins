# Control Flow Graph Dot Graph Generating

## Introduction

This IDA Pro plugin will loop in every basic block in every function in the disassembly and generates a dot directed graph file representing the control flow of all the instructions in each function.

## CFG

The dot graph file generated from its function will be named after the function address as `<function_address>.dot`. Each node in the dot directed graph file is the address of an instruction (only one node per instruction address). The edges in the dot directed graph file go from each instruction to the next instructions which execute immediately after it.

## Def Use List

Define and use list is added to each node's label. For each node, the plugin will build a list of the regisers and memory locations which that instruction defines and uses. 

## Sample

Suppose the plugin observes the following sequence of instructions:

```
0x634:             mov esi, 1 
0x635:             test [ebp+arg_0], esi
0x636:             jne loc_skip
0x637:             mov esi, 2
0x638:             jmp loc_end
0x639: loc_skip:
                   pop esi
0x63A: loc_end:
                   mov eax, esi
0x63B:             ret
```

The final dot directed graph file generated by the plugin is as follows:

```
digraph controlflow {
    n1     [label =  "0x634; D: esi, U:"];
    n2     [label = "0x635; D: eflags, U: ebp, esi, [ebp+arg_0]"];
    n3     [label = "0x636; D: U: eflags"];
    n4     [label = "0x637; D: esi, U:"];
    n5     [label = "0x638; D: U:"];
    n6     [label = "0x639; D: esi, esp U: esp, [esp]"];
    n7     [label = "0x63A; D: eax, U: esi"];
    n8     [label = "0x63B; D: U:"];

    n1 -> n2;
    n2 -> n3;
    n3 -> n4;
    n4 -> n5;
    n5 -> n7;
    n7 -> n8;
    n3 -> n6;
    n6-> n7;
}
```

