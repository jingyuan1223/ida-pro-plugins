# Data Dependence

## Introduction

X is data dependent on Y if and only if there is a variable that is defined at Y and used at X and there exists a path of nonzero length from Y to X along which V is not re-defined.

This IDA pro plugin will loop every instruction in every basic block in every function in the disassembly and computes the data dependence of each instruction. For each function, the plugin will generate a dot directed graph file representing the data dependence of all the instructions in this function. The dot graph file is named after function address as `<function_address>.dot`. Each node in the dot directed graph file is the address of an instruction (only one node per instruction address). And the edges in the dot directed graph file go from each instruction to any instruction which that instruction is data dependent on.

## DU Chains

Data dependence is calculated per statement and the result is rarely aggregated per basic block. This plugin implementation models the data dependence with the DU chains (Def-Use chains), which link the definition of a variable and the use of the variable. The advantage of this solution is that it's fast to collect data dependencies. But due to the necessity of computation and storage of every variable, it requires huge memory space and cannot omit unused variable.

## Sample

Suppose the plugin observes the following partial sequence of instructions:

```
.text:0000000000000000 var_ReturnVal = dword ptr -1Ch
.text:0000000000000000 var_Y = dword ptr -18h
.text:0000000000000000 var_X = dword ptr -14h
.text:0000000000000000 var_Z = dword ptr -8
.text:0000000000000000 var_Power = dword ptr -4
.text:0000000000000000
.text:0000000000000000 push rbp
.text:0000000000000001 mov rbp, rsp
.text:0000000000000004 mov [rbp+var_X], edi
.text:0000000000000007 mov [rbp+var_Y], esi
.text:000000000000000A cmp [rbp+var_Y], 0
.text:000000000000000E jns short loc_1A 
.text:0000000000000010 mov eax, [rbp+var_Y]
.text:0000000000000013 neg eax 
.text:0000000000000015 mov [rbp+var_Power], eax
.text:0000000000000018 jmp short loc_20
```

The final dot directed graph file generated by the plugin for this partial sequence is as follows:

```
digraph datadependence {
	n1     [label = "0x00; D: U: rbp"];
    n2     [label = "0x01; D: rbp, U: rsp"];
    n3     [label = "0x04; D: [rbp+var_X], U: edi"];
    n4     [label = "0x07; D: [rbp+var_Y], U: esi"];
    n5     [label = "0x0A; D: U: [rbp+var_Y]"];
    n6     [label = "0x0E; D: U:"];
    n7     [label = "0x10; D: eax, U: [rbp+var_Y]"];
    n8     [label = "0x13; D: eax, U: eax"];
    n9	   [label = "0x15; D: [rbp+var_Power], U: eax"];
    n10	   [label = "0x18; D: U:"]

    n2 -> n5;
    n2 -> n7;
    n4 -> n5;
    n4 -> n7;
    n7 -> n8;
    n8 -> n9;
}
```

